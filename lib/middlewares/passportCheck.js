"use strict";

require("source-map-support/register");

module.exports = (options, app) => {
  return async (ctx, next) => {
    if (ctx.isAuthenticated()) {
      return next();
    }

    if (options.successReturnToOrRedirect && ctx.session) {
      ctx.session.returnTo = ctx.originalUrl || ctx.url;
    }

    return ctx.redirect(options.loginUrl);
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlcy9wYXNzcG9ydENoZWNrLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJvcHRpb25zIiwiYXBwIiwiY3R4IiwibmV4dCIsImlzQXV0aGVudGljYXRlZCIsInN1Y2Nlc3NSZXR1cm5Ub09yUmVkaXJlY3QiLCJzZXNzaW9uIiwicmV0dXJuVG8iLCJvcmlnaW5hbFVybCIsInVybCIsInJlZGlyZWN0IiwibG9naW5VcmwiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBY0FBLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixDQUFDQyxPQUFELEVBQVVDLEdBQVYsS0FBa0I7QUFFL0IsU0FBTyxPQUFPQyxHQUFQLEVBQVlDLElBQVosS0FBcUI7QUFDeEIsUUFBSUQsR0FBRyxDQUFDRSxlQUFKLEVBQUosRUFBMkI7QUFDdkIsYUFBT0QsSUFBSSxFQUFYO0FBQ0g7O0FBRUQsUUFBSUgsT0FBTyxDQUFDSyx5QkFBUixJQUFxQ0gsR0FBRyxDQUFDSSxPQUE3QyxFQUFzRDtBQUNsREosTUFBQUEsR0FBRyxDQUFDSSxPQUFKLENBQVlDLFFBQVosR0FBdUJMLEdBQUcsQ0FBQ00sV0FBSixJQUFtQk4sR0FBRyxDQUFDTyxHQUE5QztBQUNIOztBQUVELFdBQU9QLEdBQUcsQ0FBQ1EsUUFBSixDQUFhVixPQUFPLENBQUNXLFFBQXJCLENBQVA7QUFDSCxHQVZEO0FBV0gsQ0FiRCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIE1pZGRsZXdhcmUgdG8gY2hlY2sgdXNlciBsb2dnZWQgaW4gc3RhdHVzIGJhc2VkIG9uIHBhc3Nwb3J0XG4gKiBAbW9kdWxlIE1pZGRsZXdhcmVfUGFzc3BvcnRDaGVja1xuICovXG5cbi8qKlxuICogSW5pdGlhbGl6ZSBlbnN1cmVMb2dnZWRJbiBtaWRkbGV3YXJlXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9uc1xuICogQHByb3BlcnR5IHtzdHJpbmd9IFtvcHRpb25zLmxvZ2luVXJsXSAtIElmIGdpdmVuLCB3aWxsIHJlZGlyZWN0IHRvIGxvZ2luVXJsIGlmIG5vdCBsb2dnZWRJblxuICogQHByb3BlcnR5IHtib29sZWFufSBbb3B0aW9ucy5zdWNjZXNzUmV0dXJuVG9PclJlZGlyZWN0XSAtIElmIGdpdmVuLCB3aWxsIHJlZGlyZWN0IHRvIGxvZ2luVXJsIGlmIG5vdCBsb2dnZWRJblxuICogQHBhcmFtIHtSb3V0YWJsZX0gYXBwXG4gKi8gIFxubW9kdWxlLmV4cG9ydHMgPSAob3B0aW9ucywgYXBwKSA9PiB7XG5cbiAgICByZXR1cm4gYXN5bmMgKGN0eCwgbmV4dCkgPT4ge1xuICAgICAgICBpZiAoY3R4LmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuc3VjY2Vzc1JldHVyblRvT3JSZWRpcmVjdCAmJiBjdHguc2Vzc2lvbikge1xuICAgICAgICAgICAgY3R4LnNlc3Npb24ucmV0dXJuVG8gPSBjdHgub3JpZ2luYWxVcmwgfHwgY3R4LnVybDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjdHgucmVkaXJlY3Qob3B0aW9ucy5sb2dpblVybCk7XG4gICAgfVxufTsiXX0=
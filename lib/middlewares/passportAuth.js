"use strict";

require("source-map-support/register");

const {
  InvalidConfiguration
} = require('../Errors');

let createMiddleware = (opt, app) => {
  if (!opt || !opt.strategy) {
    throw new InvalidConfiguration('Missing strategy name.', app, 'middlewares.passportAuth.strategy');
  }

  let passportService = app.getService('passport');

  if (!passportService) {
    throw new InvalidConfiguration('Passport feature is not enabled.', app, 'passport');
  }

  return passportService.authenticate(opt.strategy, opt.options);
};

module.exports = createMiddleware;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlcy9wYXNzcG9ydEF1dGguanMiXSwibmFtZXMiOlsiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJyZXF1aXJlIiwiY3JlYXRlTWlkZGxld2FyZSIsIm9wdCIsImFwcCIsInN0cmF0ZWd5IiwicGFzc3BvcnRTZXJ2aWNlIiwiZ2V0U2VydmljZSIsImF1dGhlbnRpY2F0ZSIsIm9wdGlvbnMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU07QUFBRUEsRUFBQUE7QUFBRixJQUEyQkMsT0FBTyxDQUFDLFdBQUQsQ0FBeEM7O0FBZUEsSUFBSUMsZ0JBQWdCLEdBQUcsQ0FBQ0MsR0FBRCxFQUFNQyxHQUFOLEtBQWM7QUFDakMsTUFBSSxDQUFDRCxHQUFELElBQVEsQ0FBQ0EsR0FBRyxDQUFDRSxRQUFqQixFQUEyQjtBQUN2QixVQUFNLElBQUlMLG9CQUFKLENBQ0Ysd0JBREUsRUFFRkksR0FGRSxFQUdGLG1DQUhFLENBQU47QUFLSDs7QUFFRCxNQUFJRSxlQUFlLEdBQUdGLEdBQUcsQ0FBQ0csVUFBSixDQUFlLFVBQWYsQ0FBdEI7O0FBRUEsTUFBSSxDQUFDRCxlQUFMLEVBQXNCO0FBQ2xCLFVBQU0sSUFBSU4sb0JBQUosQ0FDRixrQ0FERSxFQUVGSSxHQUZFLEVBR0YsVUFIRSxDQUFOO0FBS0g7O0FBRUQsU0FBT0UsZUFBZSxDQUFDRSxZQUFoQixDQUE2QkwsR0FBRyxDQUFDRSxRQUFqQyxFQUEyQ0YsR0FBRyxDQUFDTSxPQUEvQyxDQUFQO0FBQ0gsQ0FwQkQ7O0FBc0JBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJULGdCQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCB7IEludmFsaWRDb25maWd1cmF0aW9uIH0gPSByZXF1aXJlKCcuLi9FcnJvcnMnKTtcblxuLyoqXG4gKiBQYXNzcG9ydCBpbml0aWFsaXphdGlvbiBtaWRkbGV3YXJlLCByZXF1aXJlZCB0byBpbml0aWFsaXplIFBhc3Nwb3J0IHNlcnZpY2UuXG4gKiBAbW9kdWxlIE1pZGRsZXdhcmVfUGFzc3BvcnRBdXRoXG4gKi9cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXNzcG9ydCBhdXRoZW50aWNhdGlvbiBtaWRkbGV3YXJlLlxuICogQHBhcmFtIHtvYmplY3R9IG9wdCAtIFBhc3Nwb3J0IG9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBvcHQuc3RyYXRlZ3kgLSBQYXNzcG9ydCBzdHJhdGVneVxuICogQHByb3BlcnR5IHtvYmplY3R9IFtvcHQub3B0aW9uc10gLSBQYXNzcG9ydCBzdHJhdGVneSBvcHRpb25zIFxuICogQHBhcmFtIHtSb3V0YWJsZX0gYXBwXG4gKiBAcmV0dXJucyB7S29hQWN0aW9uRnVuY3Rpb259XG4gKi9cbmxldCBjcmVhdGVNaWRkbGV3YXJlID0gKG9wdCwgYXBwKSA9PiB7XG4gICAgaWYgKCFvcHQgfHwgIW9wdC5zdHJhdGVneSkge1xuICAgICAgICB0aHJvdyBuZXcgSW52YWxpZENvbmZpZ3VyYXRpb24oXG4gICAgICAgICAgICAnTWlzc2luZyBzdHJhdGVneSBuYW1lLicsIFxuICAgICAgICAgICAgYXBwLCBcbiAgICAgICAgICAgICdtaWRkbGV3YXJlcy5wYXNzcG9ydEF1dGguc3RyYXRlZ3knXG4gICAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIGxldCBwYXNzcG9ydFNlcnZpY2UgPSBhcHAuZ2V0U2VydmljZSgncGFzc3BvcnQnKTtcblxuICAgIGlmICghcGFzc3BvcnRTZXJ2aWNlKSB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkQ29uZmlndXJhdGlvbihcbiAgICAgICAgICAgICdQYXNzcG9ydCBmZWF0dXJlIGlzIG5vdCBlbmFibGVkLicsXG4gICAgICAgICAgICBhcHAsXG4gICAgICAgICAgICAncGFzc3BvcnQnXG4gICAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBwYXNzcG9ydFNlcnZpY2UuYXV0aGVudGljYXRlKG9wdC5zdHJhdGVneSwgb3B0Lm9wdGlvbnMpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVNaWRkbGV3YXJlOyJdfQ==
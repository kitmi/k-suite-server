"use strict";

require("source-map-support/register");

const path = require('path');

const {
  Literal
} = require('..').enum;

const {
  InvalidConfiguration
} = require('../Errors');

const koaError = require('koa-error');

module.exports = (options, app) => {
  if (!options.template) {
    if (options.engine && options.engine !== 'swig') {
      throw new InvalidConfiguration('Missing template option.', app, 'middlewares.templatedError.template');
    }

    options.template = 'defaultError.swig';
  }

  options.template = path.resolve(app.backendPath, Literal.VIEWS_PATH, options.template);

  if (!options.engine) {
    options.engine = 'swig';
  }

  return koaError(options);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlcy90ZW1wbGF0ZWRFcnJvci5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsIkxpdGVyYWwiLCJlbnVtIiwiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJrb2FFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJvcHRpb25zIiwiYXBwIiwidGVtcGxhdGUiLCJlbmdpbmUiLCJyZXNvbHZlIiwiYmFja2VuZFBhdGgiLCJWSUVXU19QQVRIIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQU9BLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQTtBQUFGLElBQWNELE9BQU8sQ0FBQyxJQUFELENBQVAsQ0FBY0UsSUFBbEM7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQTtBQUFGLElBQTJCSCxPQUFPLENBQUMsV0FBRCxDQUF4Qzs7QUFXQSxNQUFNSSxRQUFRLEdBQUdKLE9BQU8sQ0FBQyxXQUFELENBQXhCOztBQUVBSyxNQUFNLENBQUNDLE9BQVAsR0FBaUIsQ0FBQ0MsT0FBRCxFQUFVQyxHQUFWLEtBQWtCO0FBQy9CLE1BQUksQ0FBQ0QsT0FBTyxDQUFDRSxRQUFiLEVBQXVCO0FBQ25CLFFBQUlGLE9BQU8sQ0FBQ0csTUFBUixJQUFrQkgsT0FBTyxDQUFDRyxNQUFSLEtBQW1CLE1BQXpDLEVBQWlEO0FBQzdDLFlBQU0sSUFBSVAsb0JBQUosQ0FDRiwwQkFERSxFQUVGSyxHQUZFLEVBR0YscUNBSEUsQ0FBTjtBQUtIOztBQUVERCxJQUFBQSxPQUFPLENBQUNFLFFBQVIsR0FBbUIsbUJBQW5CO0FBQ0g7O0FBRURGLEVBQUFBLE9BQU8sQ0FBQ0UsUUFBUixHQUFtQlYsSUFBSSxDQUFDWSxPQUFMLENBQWFILEdBQUcsQ0FBQ0ksV0FBakIsRUFBOEJYLE9BQU8sQ0FBQ1ksVUFBdEMsRUFBa0ROLE9BQU8sQ0FBQ0UsUUFBMUQsQ0FBbkI7O0FBRUEsTUFBSSxDQUFDRixPQUFPLENBQUNHLE1BQWIsRUFBcUI7QUFDakJILElBQUFBLE9BQU8sQ0FBQ0csTUFBUixHQUFpQixNQUFqQjtBQUNIOztBQUVELFNBQU9OLFFBQVEsQ0FBQ0csT0FBRCxDQUFmO0FBQ0gsQ0FwQkQiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBFcnJvciByZXNwb25zZSBtaWRkbGV3YXJlIHdpdGggdGVtcGxhdGUgZW5naW5lc1xuICogQG1vZHVsZSBNaWRkbGV3YXJlX1RlbXBsYXRlZEVycm9yXG4gKi9cblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IHsgTGl0ZXJhbCB9ID0gcmVxdWlyZSgnLi4nKS5lbnVtO1xuY29uc3QgeyBJbnZhbGlkQ29uZmlndXJhdGlvbiB9ID0gcmVxdWlyZSgnLi4vRXJyb3JzJyk7XG5cbi8qKlxuICogQGZ1bmN0aW9uXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIFRlbXBsYXRlIG9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBvcHRpb25zLnRlbXBsYXRlIC0gUGF0aCB0byB0ZW1wbGF0ZSB3cml0dGVuIHdpdGggeW91ciB0ZW1wbGF0ZSBlbmdpbmVcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBvcHRpb25zLmVuZ2luZSAtIFBhdGggdG8gdGVtcGxhdGUgd3JpdHRlbiB3aXRoIHlvdXIgdGVtcGxhdGUgZW5naW5lXG4gKiBAcHJvcGVydHkge2Jvb2x9IG9wdGlvbnMuY2FjaGUgLSBQYXRoIHRvIHRlbXBsYXRlIHdyaXR0ZW4gd2l0aCB5b3VyIHRlbXBsYXRlIGVuZ2luZSwgZGVmYXVsdDogTk9ERV9FTlYgIT0gJ2RldmVsb3BtZW50J1xuICogQHByb3BlcnR5IHtzdHJpbmd9IFtvcHRpb25zLmVudj0nZGV2ZWxvcG1lbnQnXSAtIFBhdGggdG8gdGVtcGxhdGUgd3JpdHRlbiB3aXRoIHlvdXIgdGVtcGxhdGUgZW5naW5lXG4gKiBAcHJvcGVydHkge0FycmF5LjxzdHJpbmc+fSBvcHRpb25zLmFjY2VwdHMgLSBNaW1ldHlwZXMgcGFzc2VkIHRvIGN0eC5hY2NlcHRzLCBkZWZhdWx0OiBbICdodG1sJywgJ3RleHQnLCAnanNvbicgXVxuICoqL1xuY29uc3Qga29hRXJyb3IgPSByZXF1aXJlKCdrb2EtZXJyb3InKTtcblxubW9kdWxlLmV4cG9ydHMgPSAob3B0aW9ucywgYXBwKSA9PiB7XG4gICAgaWYgKCFvcHRpb25zLnRlbXBsYXRlKSB7ICAgICAgICBcbiAgICAgICAgaWYgKG9wdGlvbnMuZW5naW5lICYmIG9wdGlvbnMuZW5naW5lICE9PSAnc3dpZycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQ29uZmlndXJhdGlvbihcbiAgICAgICAgICAgICAgICAnTWlzc2luZyB0ZW1wbGF0ZSBvcHRpb24uJyxcbiAgICAgICAgICAgICAgICBhcHAsXG4gICAgICAgICAgICAgICAgJ21pZGRsZXdhcmVzLnRlbXBsYXRlZEVycm9yLnRlbXBsYXRlJ1xuICAgICAgICAgICAgKTsgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9ICdkZWZhdWx0RXJyb3Iuc3dpZyc7XG4gICAgfVxuXG4gICAgb3B0aW9ucy50ZW1wbGF0ZSA9IHBhdGgucmVzb2x2ZShhcHAuYmFja2VuZFBhdGgsIExpdGVyYWwuVklFV1NfUEFUSCwgb3B0aW9ucy50ZW1wbGF0ZSk7IFxuXG4gICAgaWYgKCFvcHRpb25zLmVuZ2luZSkge1xuICAgICAgICBvcHRpb25zLmVuZ2luZSA9ICdzd2lnJztcbiAgICB9XG5cbiAgICByZXR1cm4ga29hRXJyb3Iob3B0aW9ucyk7XG59ICJdfQ==